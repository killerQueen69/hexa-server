# Disaster Recovery: RPO and RTO

## Targets

- **RPO**: 24 hours (`BACKUP_RPO_MINUTES=1440`)
- **RTO**: 60 minutes (`BACKUP_RTO_MINUTES=60`)

## Backup Policy

- Encrypted backup artifacts are generated by:
  - `POST /api/v1/admin/ops/backup/run`
  - `npm run backup:run`
- Encryption: AES-256-GCM, key from `BACKUP_ENCRYPTION_KEY`.
- Retention: controlled by `BACKUP_RETENTION_COUNT` (default: 7 files).
- Storage path: `BACKUP_OUTPUT_DIR` (default: `server/data/backups`).

## Restore Drill

- Restore drill can be executed by:
  - `POST /api/v1/admin/ops/restore-drill/run`
  - `npm run restore:drill [backup_path]`
- Drill validates decryptability, backup schema integrity, table presence, and count comparison.
- Drill fails if elapsed time exceeds configured RTO target.

## Monthly Drill Procedure

1. Trigger encrypted backup.
2. Run restore drill against latest backup.
3. Verify drill result status is `ok` in `ops_backup_runs`.
4. Capture elapsed time and confirm it is within RTO.
5. Record result in release operations notes.

## Ownership

- Primary owner: platform admin on-call.
- Secondary owner: release manager.

## Incident Recovery Steps

1. Stop production writes.
2. Identify latest valid encrypted backup.
3. Decrypt and restore data set per runbook.
4. Validate service health (`/health`, `/metrics`, admin dashboard).
5. Resume traffic.
6. Publish incident summary with actual RPO/RTO achieved.
